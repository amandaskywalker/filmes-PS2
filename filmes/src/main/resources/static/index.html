<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto PG2</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>
<body>
    <div id="div-form">
        <h1>PROJETO PG2</h1>
        <button id="btn-filme">FILME</button>
        <button id="btn-ator">ATOR</button>

        <div id="filme" class="content">
            <h2>FILME</h2>
            <button onclick="listarFilmes()" id="btn-listar-filmes">Listar Filmes</button>
            <br><br>
            <form id="filme-form" onsubmit="adicionarFilme(event)">
                <input type="text" id="filme-id" placeholder="ID (para atualizar/deletar)"><br>
                <label for="filme-titulo">TÍTULO:</label>
                <input type="text" id="filme-titulo"><br>
                <label for="filme-genero">GÊNERO:</label>
                <input type="text" id="filme-genero"><br>
                <label for="filme-diretor">DIRETOR:</label>
                <input type="text" id="filme-diretor"><br>
                <label for="filme-ano">ANO:</label>
                <input type="number" id="filme-ano"><br>
                <button type="submit" id="btn-adicionar-filme">Adicionar Filme</button>
                <button type="button" onclick="atualizarFilme()" id="btn-atualizar-filme">Atualizar Filme</button>
                <button type="button" onclick="deletarFilme()" id="btn-deletar-filme">Deletar Filme</button>
            </form>
            <div id="filme-list"></div>
        </div>

        <div id="ator" class="content">
            <h2>ATOR</h2>
            <button onclick="listarAtores()" id="btn-listar-atores">Listar Atores</button>
            <br><br>
            <form id="ator-form" onsubmit="adicionarAtor(event)">
                <input type="text" id="ator-id" placeholder="ID (para atualizar/deletar)"><br>
                <label for="ator-nome">NOME:</label>
                <input type="text" id="ator-nome"><br>
                <label for="ator-idade">IDADE:</label>
                <input type="number" id="ator-idade"><br>
                <label for="ator-filme">FILME:</label>
                <input type="text" id="ator-filme"><br>
                <button type="submit" id="btn-adicionar-ator">Adicionar Ator</button>
                <button type="button" onclick="atualizarAtor()" id="btn-atualizar-ator">Atualizar Ator</button>
                <button type="button" onclick="deletarAtor()" id="btn-deletar-ator">Deletar Ator</button>
            </form>
            <div id="ator-list"></div>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.content');
            sections.forEach(section => section.style.display = 'none');
            document.getElementById(sectionId).style.display = 'block';
        }

        document.addEventListener('DOMContentLoaded', () => {
            showSection('filme');
            document.getElementById('btn-filme').addEventListener('click', () => showSection('filme'));
            document.getElementById('btn-ator').addEventListener('click', () => showSection('ator'));
        });

        function listarFilmes() {
            fetch('/filmes')
                .then(response => response.json())
                .then(data => {
                    if (!Array.isArray(data)) {
                        console.error('Resposta inesperada do servidor:', data);
                        alert('Erro ao listar filmes.');
                        return;
                    }
                    const list = document.getElementById('filme-list');
                    list.innerHTML = '';
                    data.forEach(filme => {
                        const item = document.createElement('div');
                        item.classList.add('list-item');
                        item.textContent = `ID: ${filme.id} | Título: ${filme.titulo} | Gênero: ${filme.genero} | Diretor: ${filme.diretor} | Ano: ${filme.ano}`;
                        list.appendChild(item);
                    });
                })
                .catch(error => {
                    console.error('Erro ao listar filmes:', error);
                    alert('Erro ao listar filmes.');
                });
        }

        function listarAtores() {
            fetch('/atores')
                .then(response => response.json())
                .then(data => {
                    if (!Array.isArray(data)) {
                        console.error('Resposta inesperada do servidor:', data);
                        alert('Erro ao listar atores.');
                        return;
                    }
                    const list = document.getElementById('ator-list');
                    list.innerHTML = '';
                    data.forEach(ator => {
                        const item = document.createElement('div');
                        item.classList.add('list-item');
                        item.textContent = `ID: ${ator.id} | Nome: ${ator.nome} | Idade: ${ator.idade} | Filme: ${ator.filme}`;
                        list.appendChild(item);
                    });
                })
                .catch(error => {
                    console.error('Erro ao listar atores:', error);
                    alert('Erro ao listar atores.');
                });
        }

        function adicionarFilme(event) {
            event.preventDefault();
            const titulo = document.getElementById('filme-titulo').value;
            const genero = document.getElementById('filme-genero').value;
            const diretor = document.getElementById('filme-diretor').value;
            const ano = document.getElementById('filme-ano').value;

            fetch('/filmes', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({titulo, genero, diretor, ano})
            })
            .then(response => response.json())
            .then(filme => {
                alert('Filme adicionado com sucesso!');
                listarFilmes();
            })
            .catch(error => {
                console.error('Erro ao adicionar filme:', error);
                alert('Erro ao adicionar filme.');
            });
        }

        function atualizarFilme() {
            const id = document.getElementById('filme-id').value;
            const titulo = document.getElementById('filme-titulo').value;
            const genero = document.getElementById('filme-genero').value;
            const diretor = document.getElementById('filme-diretor').value;
            const ano = document.getElementById('filme-ano').value;

            fetch(`/filmes/${id}`, {
                method: 'PUT',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({titulo, genero, diretor, ano})
            })
            .then(response => response.json())
            .then(data => {
                alert('Filme atualizado com sucesso!');
                listarFilmes();
            })
            .catch(error => {
                console.error('Erro ao atualizar filme:', error);
                alert('Erro ao atualizar filme.');
            });
        }

        function deletarFilme() {
            const id = document.getElementById('filme-id').value;

            fetch(`/filmes/${id}`, {
                method: 'DELETE'
            })
            .then(response => {
                if (response.ok) {
                    alert('Filme deletado com sucesso!');
                    listarFilmes();
                } else {
                    alert('Falha ao deletar filme.');
                }
            })
            .catch(error => {
                console.error('Erro ao deletar filme:', error);
                alert('Erro ao deletar filme.');
            });
        }

        function adicionarAtor(event) {
            event.preventDefault();
            const nome = document.getElementById('ator-nome').value;
            const idade = document.getElementById('ator-idade').value;
            const filme = document.getElementById('ator-filme').value;

            fetch('/atores', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({nome, idade, filme})
            })
            .then(response => response.json())
            .then(ator => {
                alert('Ator adicionado com sucesso!');
                listarAtores();
            })
            .catch(error => {
                console.error('Erro ao adicionar ator:', error);
                alert('Erro ao adicionar ator.');
            });
        }

        function atualizarAtor() {
            const id = document.getElementById('ator-id').value;
            const nome = document.getElementById('ator-nome').value;
            const idade = document.getElementById('ator-idade').value;
            const filme = document.getElementById('ator-filme').value;

            fetch(`/atores/${id}`, {
                method: 'PUT',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({nome, idade, filme})
            })
            .then(response => response.json())
            .then(data => {
                alert('Ator atualizado com sucesso!');
                listarAtores();
            })
            .catch(error => {
                console.error('Erro ao atualizar ator:', error);
                alert('Erro ao atualizar ator.');
            });
        }

        function deletarAtor() {
            const id = document.getElementById('ator-id').value;

            fetch(`/atores/${id}`, {
                method: 'DELETE'
            })
            .then(response => {
                if (response.ok) {
                    alert('Ator deletado com sucesso!');
                    listarAtores();
                } else {
                    alert('Falha ao deletar ator.');
                }
            })
            .catch(error => {
                console.error('Erro ao deletar ator:', error);
                alert('Erro ao deletar ator.');
            });
        }
    </script>
</body>
</html>
